# ReMAPP Aim 1 Analysis â€“ Healthy Cohort Construction & Reference Hemoglobin Limits

## Description

This analytic pipeline supports ReMAPP Aim 1, which constructs a Healthy Pregnancy Cohort and models the non-linear relationship between gestational age (GA, weeks) and maternal hemoglobin (Hb, g/dL) during pregnancy.
The primary analytic method is fractional polynomial regression (FPR), selected to flexibly capture complex, non-linear Hbâ€“GA relationships that are not well represented by linear or standard polynomial models.

ðŸ“Œ Versioning
#### :pushpin: Updated on 2026-01-14
#### :pushpin: Originally drafted by: Xiaoyan Hu (xyh@gwu.edu)
#### :pushpin: Modified and extended by: Precious Williams (williams_pj@gwu.edu)

## Directory Structure & Pipeline Flow
## Script Order

### 1. `1_remapp_one_prep.R` â€” Data Preparation & Cohort Construction
This script performs all data loading, harmonization, eligibility determination, and derivation of analysis-ready datasets.
All outputs generated by this pipeline are saved to: Analysis/ReMAPP/Aim1/<Data_Upload_Date>/derived_data/
**Key steps:**
* **Load and merge data**
  * Load stacked site-level MNH forms, maternal outcome data, and cached `.rda` files
  * Select and harmonize variables required for ReMAPP Aim 1 analyses
    
* **Define healthy cohort criteria**
  * Derive all prespecified eligibility criteria across clinical, behavioral, laboratory, and anthropometric domains
* **Eligibility determination**
  * Apply criteria to define the primary healthy cohort and sensitivity cohort variants
  * Save both screening-level and participant-level eligibility outputs

* **Hemoglobin (Hb) data restructuring**
  * Prepare Hb data in both long and wide formats
  * Apply altitude and smoking adjustments
  * Exclude biologically implausible Hb values

* **Sensitivity analysis datasets**
  * Generate datasets for:
    * G6PD exclusion
    * Gestational ageâ€“based criteria
    * Preterm birth exclusion

* **Eligibility and missingness visualization inputs**
  * Prepare long-format eligibility indicators (C1â€“C20)
  * Support flow diagram construction and missingness visualization

### 2. `2_remapp_one_analysis.RMD` â€” Visualization & Modeling

This script performs exploratory data analysis and statistical modeling within the healthy cohort.
**Key components:**
* Descriptive visualization of hemoglobin distributions in the healthy cohort
* Fractional polynomial regression (FPR) modeling of hemoglobin by gestational age

### 3. `3_remapp_one_report_run.RMD` â€” Report Generation
This script orchestrates final report production.
**Functions:**
* Calls `2_remapp_one_analysis.RMD`
* Produces the ReMAPP Aim 1 report, integrating:
  * Healthy cohort construction
  * Hemoglobin centile estimation
  * Sensitivity analyses





